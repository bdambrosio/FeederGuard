<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Who's That?</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <h1>Who's That?</h1>
            <button class="settings-btn" onclick="app.toggleSettings()" aria-label="Settings">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                </svg>
            </button>
        </header>

        <!-- Camera Preview -->
        <div class="camera-container">
            <img id="camera-feed" src="/video_feed" alt="Camera feed">
            <div id="camera-overlay" class="camera-overlay hidden">
                <div class="thinking-animation">
                    <div class="eye left"></div>
                    <div class="eye right"></div>
                </div>
                <p id="thinking-text">Hmm, let me look closely...</p>
            </div>
            <img id="frozen-frame" class="frozen-frame hidden" alt="Captured frame">
        </div>

        <!-- Mode Tabs -->
        <nav class="mode-tabs">
            <button class="tab active" data-mode="look" onclick="app.switchMode('look')">
                <span class="tab-icon">üëÄ</span>
                <span class="tab-label">Look</span>
            </button>
            <button class="tab" data-mode="meet" onclick="app.switchMode('meet')">
                <span class="tab-icon">üì∏</span>
                <span class="tab-label">Meet</span>
            </button>
            <button class="tab" data-mode="who" onclick="app.switchMode('who')">
                <span class="tab-icon">üîç</span>
                <span class="tab-label">Who?</span>
            </button>
        </nav>

        <!-- Mode Content -->
        <main class="mode-content">
            <!-- Look Mode -->
            <section id="look-mode" class="mode active">
                <button class="action-btn primary" onclick="app.describeScene()">
                    What do you see?
                </button>
                <div id="look-response" class="response-box hidden"></div>
            </section>

            <!-- Meet Mode -->
            <section id="meet-mode" class="mode hidden">
                <div id="meet-capture" class="meet-capture">
                    <button class="action-btn primary" onclick="app.captureForEnroll()">
                        Say Cheese! üì∏
                    </button>
                </div>
                <div id="meet-enroll" class="meet-enroll hidden">
                    <p class="prompt">Who is this?</p>
                    <div class="input-group">
                        <input type="text" id="name-input" placeholder="Type a name..." autocomplete="off">
                        <button class="mic-btn" onclick="app.startSpeechInput('name-input')" aria-label="Voice input">
                            üé§
                        </button>
                    </div>
                    <div class="button-row">
                        <button class="action-btn secondary" onclick="app.cancelEnroll()">Cancel</button>
                        <button class="action-btn primary" onclick="app.saveEnroll()">Save</button>
                    </div>
                </div>
                <div id="library-gallery" class="library-gallery">
                    <h3>Friends I Know</h3>
                    <div id="subjects-grid" class="subjects-grid"></div>
                </div>
            </section>

            <!-- Who Mode -->
            <section id="who-mode" class="mode hidden">
                <div id="who-capture">
                    <button class="action-btn primary" onclick="app.identifySubjects()">
                        Who's That? üîç
                    </button>
                </div>
                <div id="who-response" class="response-box hidden"></div>
                <div id="chat-section" class="chat-section hidden">
                    <div class="input-group">
                        <input type="text" id="chat-input" placeholder="Ask a follow-up question..." autocomplete="off">
                        <button class="mic-btn" onclick="app.startSpeechInput('chat-input')" aria-label="Voice input">
                            üé§
                        </button>
                        <button class="send-btn" onclick="app.sendChat()">Send</button>
                    </div>
                    <button class="action-btn secondary" onclick="app.newPhoto()">New Photo</button>
                </div>
            </section>
        </main>

        <!-- Settings Panel -->
        <div id="settings-panel" class="settings-panel hidden">
            <div class="settings-content">
                <h2>Settings</h2>
                <div class="setting-group">
                    <label for="camera-url">Camera URL Override</label>
                    <input type="text" id="camera-url" placeholder="Leave empty for auto-detect">
                </div>
                <div class="setting-group">
                    <label for="vlm-url">VLM Server URL</label>
                    <input type="text" id="vlm-url">
                </div>
                <div class="setting-group">
                    <label for="volume-slider">Volume</label>
                    <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1">
                </div>
                <div class="setting-group danger">
                    <button class="action-btn danger" onclick="app.clearAllPhotos()">
                        Clear All Photos
                    </button>
                </div>
                <button class="action-btn secondary close-settings" onclick="app.toggleSettings()">
                    Close
                </button>
            </div>
        </div>

        <!-- Subject Detail Modal -->
        <div id="subject-modal" class="modal hidden">
            <div class="modal-content">
                <h3 id="modal-subject-name"></h3>
                <div id="modal-photos" class="modal-photos"></div>
                <div class="button-row">
                    <button class="action-btn secondary" onclick="app.closeSubjectModal()">Close</button>
                    <button class="action-btn primary" onclick="app.addPhotoToSubject()">Add Photo</button>
                    <button class="action-btn danger" onclick="app.forgetSubject()">Forget</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
